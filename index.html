<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Quality of Life</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        
        
    </head>
    <body>
        <center><h1>Population</h1></center>
</br>
</br>
<div class= 'display' style= 'position: relative; height:80vh; width:100vw'></div>>
        <canvas id="myChart"></canvas>

</div>
</br>

<script>
    console.log('works')
    function BuildChart(unitedStates, timeYear, chartTitle) {
    var data = {
        labels: labels,
        datasets: [{
            label: chartTitle, // Name the series
            data: values,
            backgroundColor: ['rgb(54, 162, 235)',
                'rgb(54, 162, 235)',
                'rgb(54, 162, 235)',
                'rgb(54, 162, 235)',
                'rgb(54, 162, 235)',
                'rgb(54, 162, 235)',
                'rgb(54, 162, 235)',
                'rgb(54, 162, 235)',
                'rgb(54, 162, 235)',
                'rgb(54, 162, 235)',
            ],
        }],
    };

    const ctx = document.getElementById("myChart").getContext('2d');
    const myChart = new Chart(ctx, {
        type: 'horizontalBar',
        data: data,
        options: {
            responsive: true, // Instruct chart js to respond nicely.
            maintainAspectRatio: false, // Add to prevent default behaviour of full-width/height 
            scales: {
                xAxes: [{
                        scaleLabel: {
                        display: true,
                        labelString: 'Government Population Data'
                    }
                }],
                yAxes: [{
                    scaleLabel: {
                        display: true,
                        labelString: 'Data'
                    }
                }]
            },
        }
    });

    return myChart;
}


    let xhttp= new XMLHttpRequest();
    xhttp.open('GET', `https://datausa.io/api/data?drilldowns=Nation&measures=Population`, true)
    xhttp.send()

    xhttp.onreadystatechange = 
    function() {
        
        let content = xhttp.responseText
        let json = JSON.parse(content)
        console.log(json)
        if (this.readyState === 4 && this.status == 200) {
            let unitedStates = content.map(function (e) {
                console.log('works')
                    return e.Nation
                })
                    let timeYear = content.map(function (e) {
                        return e.Year
                })
            
                    BuildChart(unitedStates, timeYear, "Government Population Data")   
                }          
        }
    

</script>
</body>
</html>